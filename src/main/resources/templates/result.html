<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="en">
<head>

    <!-- /.website title -->
    <title>Melkie - Find Authentic Food Like Home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <!-- CSS Files -->
    <link href="/css/bootstrap.css" rel="stylesheet" media="screen">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/fonts/icon-7-stroke/css/pe-icon-7-stroke.css" rel="stylesheet">
    <link href="/css/animate.css" rel="stylesheet" media="screen">
    <link href="/css/owl.theme.css" rel="stylesheet">
    <link href="/css/owl.carousel.css" rel="stylesheet">
    <link href="/css/my.css" rel="stylesheet">

    <!-- /.javascript files -->
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <!--<script src="/js/custom.js"></script>-->
    <script src="/js/jquery.sticky.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>

    <script>
        new WOW().init();
    </script>

    <!-- Colors -->
    <link href="/css/css-index.css" rel="stylesheet" media="screen">

    <!-- Google Fonts -->
    <link rel="stylesheet"
          href="http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic"/>
</head>

<body data-spy="scroll" data-target="#navbar-scroll" onload="initMap()">

<!-- /.preloader -->
<!--<div id="preloader"></div>-->
<div id="top"></div>

<!-- NAVIGATION -->
<div id="menu">
    <nav class="navbar-wrapper navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-backyard">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <h2>
                    <a href="/">
                        <strong>
                            <span th:text="${currentCountry.country_name} + '/'">country_name</span>
                            <span th:text="${currentTaste.taste_name}">taste_name</span>
                        </strong>
                    </a>
                </h2>

            </div>

            <div id="navbar-scroll" class="collapse navbar-collapse navbar-backyard navbar-right">
                <ul class="nav navbar-nav">
                    <li><a href="/">Home</a></li>
                    <li><a href="/culture_and_tips" style="color:orange">Explore Foreign Culture and Tips</a></li>
                </ul>
            </div>
        </div>
    </nav>
</div>
<div class="fullscreen landing parallax" style="background-image:url('/images/brooke-lark-230140.jpg');"
     data-img-width="2000" data-img-height="1333" data-diff="100">
    <div class="overlay">
        <!-- /.main section -->
        <div>
            <ul class="nav nav-tabs nav-justified">
                <li class="active"><a data-toggle="tab" href="#EatOutside">Eat Out</a></li>
                <li><a data-toggle="tab" href="#CookAtHome">Cook At Home</a></li>
            </ul>
        </div>

        <div class="tab-content">
            <div id="EatOutside" class="tab-pane fade in active">
                <!-- /.parallax full screen background image -->
                <div class="fullscreen landing parallax" style="background-image:url('/images/brooke-lark-230140.jpg');"
                     data-img-width="2000" data-img-height="1333" data-diff="100">
                    <div class="overlay">
                        <iframe th:src="@{'https://www.google.com/maps/embed/v1/place?key=AIzaSyAABKsQey-XPjwR-wtUdWPtf7VqS-MXS7k&q=place_id:' + ${currentRestaurant.restaurant_placeID}}"
                                width="100%" height="300" frameborder="0" allowfullscreen></iframe>


                        <div id="detailView" class="container">
                            <div class="row">
                                <div class="col-md-6 col-sm-6">
                                    <div class="row">
                                        <div class="panel panel-default">
                                            <div class="panel-heading list-heading">
                                                <div style="font-size: xx-large">
                                                    <strong>Top 5 Authentic Restaurants</strong>
                                                </div>
                                                <span></span>
                                            </div>

                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <th class="col-xs-6">Name</th>
                                                    <th class="col-xs-3">Category</th>
                                                    <th class="col-xs-3">Google Rating</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <th:block th:each="restaurant,itrStat : ${restaurantList}">
                                                    <tr class="body-text">
                                                        <td class="col-xs-2"><a
                                                                th:text="${restaurant.restaurant_name}"
                                                                th:href="@{'/result/' + ${currentTaste.taste_id} + '/' + ${itrStat.index} + '/0'}">rest_name</a>
                                                        </td>
                                                        <td class="col-xs-8"><span th:text="${currentTaste.taste_name}">taste_name</span>
                                                        </td>
                                                        <td class="col-xs-2"><span
                                                                th:text="${restaurant.restaurant_googleRating}">rest_likes</span>
                                                            <!--<i onclick="likeButtonClicked(this)" class="fa fa-thumbs-up like-button" th:id="${itrStat.index}"></i>-->
                                                            <!--<script th:inline="javascript">-->
                                                            <!--function likeButtonClicked() {-->
                                                            <!--var id = event.target.id;-->
                                                            <!--var eee = [[${likesList}]];-->
                                                            <!--//                                                                    alert("Thanks for your like!" + eee[id]);-->
                                                            <!--var number = eee[id];-->
                                                            <!--number++;-->
                                                            <!--//                                                                    var value = parseInt(document.getElementById(id).getAttribute("th:text"), 10);-->
                                                            <!--//                                                                    value = isNaN(value) ? 0 : value;-->
                                                            <!--//                                                                    value++;-->
                                                            <!--document.getElementById(id).setAttribute("text", number.toString());-->
                                                            <!--//                                disable button-->
                                                            <!--document.getElementById(id).disabled = true;-->
                                                            <!--//                                alert("Thanks for your like!" + parseInt(document.getElementById(id).getAttribute("text"));-->
                                                            <!--}-->
                                                            <!--</script>-->
                                                        </td>
                                                    </tr>
                                                </th:block>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1 col-sm-1">
                                </div>
                                <div class="col-md-5 col-sm-5">
                                    <div class="card" style="color: #FFFFFF">
                                        <div class="card-block">
                                            <div>
                                                <h2 class="card-title detail-restaurant-name"
                                                    th:text="${currentRestaurant.restaurant_name}">Restaurant_Name</h2>
                                            </div>
                                        </div>
                                        <div class="card-block">
                                            <div class="row">
                                                <div>
                                                    <i class="fa fa-location-arrow detail-icons"></i>
                                                    <span class="card-subtitle detail-address"
                                                          th:text="${currentRestaurant.restaurant_address}">Restaurant_Address</span>
                                                </div>
                                            </div>
                                            <div class="row" style="padding-top: 15px">
                                                <i class="fa fa-star detail-icons" aria-hidden="true"></i>
                                                <span class="card-text"> Google Rating: </span>
                                                <span class="card-text download-text"
                                                      th:text="${currentRestaurant.restaurant_googleRating}">Restaurant_Rating</span>
                                            </div>

                                            <div class="row" style="padding-top: 15px">
                                                <i class="fa fa-phone-square detail-icons"></i>
                                                <span class="card-text"> Phone Number: </span>
                                                <span th:text="${currentRestaurant.phoneNumber}">Restaurant_Phone_Number</span>
                                            </div>

                                            <div class="row" style="padding-top: 15px">
                                                <i class="fa fa-cutlery detail-icons" aria-hidden="true"></i>
                                                <span class="card-text"> Seats Available: </span>
                                                <!--<span th:if="${currentRestaurant.restaurant_seats == null}">-->
                                                <!--<span>No Seats Data Availale</span>-->
                                                <!--</span>-->
                                                <!--<span th:text="${someObject.someProperty != null} ? ${someObject.someProperty} : 'null value!'">someValue</span>-->

                                                <!--<span th:if="${currentRestaurant.restaurant_seats != null}">-->

                                                <!--restaurant seats will be -1 if the value is not available-->
                                                <span th:text="${currentRestaurant.restaurant_seats != -1} ? ${currentRestaurant.restaurant_seats} : ' Seats information not available'">Restaurant_Seats</span>
                                                <!--</span>-->
                                            </div>

                                            <!--<div class="row" style="padding-top: 15px">-->
                                                <!--<i class="fa fa-thumbs-up detail-icons" aria-hidden="true"></i>-->
                                                <!--<span class="card-text"> Likes in Melkie: </span>-->
                                                <!--<span th:text="${currentRestaurant.likes}">Restaurant_Likes</span>-->
                                            <!--</div>-->

                                            <div class="row" style="padding-top: 15px">
                                                <span>
                                                    <i class="fa fa-external-link detail-icons"></i>
                                                    <span>
                                                        <span th:if="${currentRestaurant.websiteLink.equals('Not available')}">
                                                            <span>Website information not available</span>
                                                        </span>
                                                        <span th:if="${!currentRestaurant.websiteLink.equals('Not available')}">
                                                            <span><a th:href="${currentRestaurant.websiteLink}" class="card-link">Restaurant Website Link</a></span>
                                                        </span>
                                                    </span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="CookAtHome" class="tab-pane fade">
                <div id="recipeView" class="container">
                    <script th:inline="javascript">
                        $( document ).ready(function() {
                            var url = window.location;

                            // SUBMIT FORM
                            $('#form1').submit(function(event) {
                                // Prevent the form from submitting via the browser.
                                event.preventDefault();
                                var index = $('#img1').val();
                                ajaxPost(index);
                            });
                            $('#form2').submit(function(event) {
                                // Prevent the form from submitting via the browser.
                                event.preventDefault();
                                var index = $('#img2').val();
                                ajaxPost(index);
                            });
                            $('#form3').submit(function(event) {
                                // Prevent the form from submitting via the browser.
                                event.preventDefault();
                                var index = $('#img3').val();
                                ajaxPost(index);
                            });
                            $('#form4').submit(function(event) {
                                // Prevent the form from submitting via the browser.
                                event.preventDefault();
                                var index = $('#img4').val();
                                ajaxPost(index);
                            });
                            $('#form5').submit(function(event) {
                                // Prevent the form from submitting via the browser.
                                event.preventDefault();
                                var index = $('#img5').val();
                                ajaxPost(index);
                            });

                            function ajaxPost(index){
                                $.ajax({
                                    type : "POST",
                                    contentType : "application/json",
                                    url : "/postimage",
//                                    data : JSON.stringify(formData),
                                    data : index,
                                    dataType : 'json',
                                    success : function(result) {
                                        $('#recipe_name').html("<span id=\"recipe_name\" class=\"recipe-header\">" + result.data.recipe_name +  "</span>");
                                        $('#recipe_time').html("<span id=\"recipe_time\">" + result.data.total_time_in_seconds + "</span>");
                                        $('#recipe_yummly_rating').html("<span id=\"recipe_yummly_rating\">" + result.data.recipe_yummly_rating + "</span>");
//                                        $('#direction_link').html("<form id=\"direction_link\" action=\"" + result.data.direction_link + "\">" +
//                                                                    "<button class=\"btn btn-warning btn-block btn-lg\" type=\"submit\">Get Recipe Instructions</button>" +
//                                                                    "</form>");
                                        $('#direction_link').html("<a style='font-size: x-large' href='" + result.data.direction_link +"'>Get Recipe Instructions</a>");

                                        var ingredients = result.data.ingredients;
                                        $('#ingredients').html(makeUL(ingredients));
                                        $('#ingredients').id = 'ingredients';
                                    },
                                    error : function(e) {
                                        alert("Error!")
                                        console.log("ERROR: ", e);
                                    }
                                });
                            }
                        })

                        function makeUL(array) {
                            // Create the list element:
                            var list = document.createElement('ul');
                            list.style.listStyleType = 'circle';
                            for(var i = 0; i < array.length; i++) {
                                // Create the list item:
                                var item = document.createElement('li');
                                // Set its contents:
                                item.innerText = array[i];
//                                item.appendChild(document.createTextNode(array[i]));
                                // Add it to the list:
                                list.appendChild(item);
                            }

                            // Finally, return the constructed list:
                            return list;
                        }
                    </script>
                    <div class="row">
                        <div class="col-sm-9 col-md-9">
                            <div class="card h-70" style="color: #FFFFFF">
                                <h2>Popular Recipe for <span th:text="${currentTaste.taste_name}"></span></h2>
                                <div class="card-top">
                                    <div class="row" style="padding-top: 20px">
                                        <div class="col-md-2">
                                            <form id="form1" name="imgform">
                                            <div id="thumbnail0" class="thumbnail" style="width: 120px; height: 120px;">
                                                <a th:href="@{'/result/' + ${currentTaste.taste_id} + '/0'  + '/0'}">
                                                    <input id="img1" name="recipeimg" type="image" th:src="${recipeList.get(0).image_url}" value="0"
                                                         alt="Image Not Available"
                                                         height="110px" width="110px">
                                                </a>
                                                <div id="recipe0" class="privacy text-center" style="padding-top: 5px"
                                                     th:text="${recipeList.get(0).recipe_name}"></div>
                                            </div>
                                            </form>
                                        </div>
                                        <div class="col-md-2">
                                            <form id="form2" name="imgform">
                                                <div id="thumbnail1" class="thumbnail" style="width: 120px; height: 120px;">
                                                    <a th:href="@{'/result/' + ${currentTaste.taste_id} + '/0'  + '/1'}">
                                                        <input id="img2" name="recipeimg" type="image" th:src="${recipeList.get(1).image_url}" value="1"
                                                               alt="Image Not Available"
                                                               height="110px" width="110px">
                                                    </a>
                                                    <div id="recipe1" class="privacy text-center" style="padding-top: 5px"
                                                         th:text="${recipeList.get(1).recipe_name}"></div>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="col-md-2">
                                            <form id="form3" name="imgform">
                                                <div id="thumbnail3" class="thumbnail" style="width: 120px; height: 120px;">
                                                    <a th:href="@{'/result/' + ${currentTaste.taste_id} + '/0'  + '/2'}">
                                                        <input id="img3" name="recipeimg" type="image" th:src="${recipeList.get(2).image_url}" value="2"
                                                               alt="Image Not Available"
                                                               height="110px" width="110px">
                                                    </a>
                                                    <div id="recipe2" class="privacy text-center" style="padding-top: 5px"
                                                         th:text="${recipeList.get(2).recipe_name}"></div>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="col-md-2">
                                            <form id="form4" name="imgform">
                                                <div id="thumbnail4" class="thumbnail" style="width: 120px; height: 120px;">
                                                    <a th:href="@{'/result/' + ${currentTaste.taste_id} + '/0'  + '/3'}">
                                                        <input id="img4" name="recipeimg" type="image" th:src="${recipeList.get(3).image_url}" value="3"
                                                               alt="Image Not Available"
                                                               height="110px" width="110px">
                                                    </a>
                                                    <div id="recipe3" class="privacy text-center" style="padding-top: 5px"
                                                         th:text="${recipeList.get(3).recipe_name}"></div>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="col-md-2">
                                            <form id="form5" name="imgform">
                                                <div id="thumbnail5" class="thumbnail" style="width: 120px; height: 120px;">
                                                    <a th:href="@{'/result/' + ${currentTaste.taste_id} + '/0'  + '/4'}">
                                                        <input id="img5" name="recipeimg" type="image" th:src="${recipeList.get(4).image_url}" value="4"
                                                               alt="Image Not Available"
                                                               height="110px" width="110px">
                                                    </a>
                                                    <div id="recipe4" class="privacy text-center" style="padding-top: 5px"
                                                         th:text="${recipeList.get(4).recipe_name}"></div>
                                                </div>
                                            </form>
                                        </div>
                                    </div><!--.row-->
                                </div>

                                <div class="card-body" style="padding-top: 40px">
                                    <div class="card-head">
                                        <div class="row">
                                            <span id="recipe_name" class="recipe-header" th:text="${currentRecipe.recipe_name}">recipe_name</span>
                                        </div>
                                        <div class="row">
                                            <span style="alignment:right">
                                                    Recipe search powered by
                                                <a href='http://www.yummly.co/recipes'>
                                                    <img alt='Yummly' src='https://static.yummly.co/api-logo.png'/>
                                                </a>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="card-block">
                                        <div class="row" style="padding-top: 20px">
                                            <i class="fa fa-clock-o attribute-text" aria-hidden="true"></i>
                                            <span class="attribute-text">Total Cooking Time:
                                                <span id="recipe_time" th:text="${currentRecipe.total_time_in_seconds}"></span>
                                                <span> minutes</span>
                                            </span>
                                        </div>

                                        <div class="row" style="padding-top: 15px">
                                            <i class="fa fa-smile-o attribute-text" aria-hidden="true"></i>
                                            <span class="attribute-text">Yummly Rating:
                                                <span id="recipe_yummly_rating" th:text="${currentRecipe.recipe_yummly_rating}"></span>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="row" style="padding-top: 20px">
                                        <a style="font-size: x-large; color: orange" th:href="${currentRecipe.direction_link}">---> Get Recipe Direction</a>
                                    </div>

                                    <div class="row" style="padding-top: 20px; padding-bottom: 20px">
                                        <!--google map-->

                                        <h2>Grocery map for <span th:text="${currentTaste.taste_name} + ' ---> '"></span> <a onclick="initMap()" >Show map</a></h2>
                                        <div id="mapCanvas" style="width: 100%; height: 300px; color: #FFFFFF" onload="initMap()"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3 col-md-3" style="padding-top: 20px">
                            <div class="panel panel-success">
                                <div class="panel-heading">Ingredients</div>
                                <div class="panel-body">
                                    <ul class="bulletpoints" id="ingredients">
                                        <li th:each="ingredient : ${currentRecipe.ingredients}">
                                            <!--<input type="checkbox">-->
                                            <span th:text="${ingredient}"></span>
                                        </li>
                                    </ul>

                                    <div id="mapTips" class="alert alert-info">
                                        <strong>Tips:</strong>
                                        <br/>Out of stock? Check out the groceries map.
                                        <br/><strong>Click the full screen button on top right of the map to get a
                                        better view</strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- /.footer -->
<footer id="footer">
    <div class="container">
        <div class="col-sm-4 col-sm-offset-4">
            <!-- /.social links -->
            <!--<div class="social text-center">-->
                <!--<ul>-->
                    <!--<li><a class="wow fadeInUp" href="https://twitter.com/"><i class="fa fa-twitter"></i></a>-->
                    <!--</li>-->
                    <!--<li><a class="wow fadeInUp" href="https://www.facebook.com/" data-wow-delay="0.2s"><i-->
                            <!--class="fa fa-facebook"></i></a></li>-->
                    <!--<li><a class="wow fadeInUp" href="https://plus.google.com/" data-wow-delay="0.4s"><i-->
                            <!--class="fa fa-google-plus"></i></a></li>-->
                    <!--<li><a class="wow fadeInUp" href="https://instagram.com/" data-wow-delay="0.6s"><i-->
                            <!--class="fa fa-instagram"></i></a></li>-->
                <!--</ul>-->
            <!--</div>-->
            <div class="text-center wow fadeInUp" style="font-size: 14px;">Copyright Team Supreme 2017</div>
            <a href="#" class="scrollToTop"><i class="pe-7s-up-arrow pe-va"></i></a>
        </div>
    </div>
</footer>
<!--google map scripts-->
<script th:inline="javascript">
    function initMap() {
        var map;
        var bounds = new google.maps.LatLngBounds();
        var mapOptions = {
            mapTypeId: 'roadmap'
        };

        //get value from thymeleaf
        var markers = [[${markers}]];

        // Display a map on the web page
        map = new google.maps.Map(document.getElementById("mapCanvas"), mapOptions);
        map.setTilt(50);

        // Add multiple markers to map
//        var infoWindow = new google.maps.InfoWindow(), marker, i;

        // Place each marker on the map
        for (i = 0; i < markers.length; i++) {
            var position = new google.maps.LatLng(markers[i][1], markers[i][2]);
            marker = new google.maps.Marker({
                position: position,
                map: map
            });
            bounds.extend(position);

            // Add info window to marker
            google.maps.event.addListener(marker, 'click', (function (marker, i) {
                return function () {
                    var contentString = '<h3 style="color: black">' + markers[i][0] + '</h3>';
                    var infoWindow = new google.maps.InfoWindow({
                        content: contentString
                    });
                    infoWindow.open(map, marker);
                }
            })(marker, i));

            // Center the map to fit all markers on the screen
            map.fitBounds(bounds);
        }
        // Set zoom level
        var boundsListener = google.maps.event.addListener((map), 'bounds_changed', function (event) {
            this.setZoom(14);
            google.maps.event.removeListener(boundsListener);
        });
    }

    // Load initialize function
    google.maps.event.addDomListener(window, 'load', initMap);
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBTicqriCSJBodECDaaSdlPgbj1W76zskI&callback=initMap"></script>
</body>
</html>